# Анализ 1tips.ru и план действий

## Что изучил на 1tips.ru

### Суть сервиса
- **Безналичные чаевые** картой/телефоном/часами: клиент сканирует QR или переходит по ссылке, выбирает сумму, платит — деньги идут на карту получателя.
- **Целевая аудитория:** рестораны, курьеры, отели, салоны красоты; получатели — официанты, мастера, барберы, курьеры.

### Ключевой сценарий (3 шага)
1. **QR/ссылка** — с визитки, чека, тейбл-тента и т.п.
2. **Сумма и отзыв** — выбор из кнопок или своя сумма, опционально текст.
3. **Оплата** — Apple Pay, Google Pay, Samsung Pay или карта; без приложений и регистрации для плательщика.

### Функции
- **Лендинг:** О сервисе, Как работает, Адаптация (момент. подключение, свой дизайн, распределение, аналитика), Для кого, FAQ, Контакты, Тарифы.
- **Авторизация:** телефон + пароль; вход, регистрация (подтверждение по звонку/коду), «Забыли пароль».
- **Личный кабинет:** виртуальная карта для зачисления; использование ссылки и QR; тарифы (6% на зачисление, 1% мин 30₽ на вывод и т.д.).

### Тарифы (референс)
- Зачисление на виртуальную карту: 6%.
- Вывод на свою карту: 1%, мин 30₽.
- Остальное — по факту из их оферты.

### Технические детали (по контенту)
- Платежи: Сбербанк, Московский индустриальный банк.
- Регистрация: звонок для ввода 4 цифр.
- Есть мобильная адаптация, иконки, простой визуал.

---

## Дальнейшие действия (в порядке выполнения)

1. **Инициализация проекта** (см. TODO: 0.1–0.4)  
   - Структура `frontend` / `backend` (или монорепо), общие типы.  
   - TS (strict), ESLint, Prettier, `.env.example`.  
   - Базовый Docker с PostgreSQL для разработки.

2. **Схема БД и миграции** (1.1–1.6)  
   - Таблицы: `users`, `sessions`, `tip_links`, `transactions`, `payout_requests`.  
   - При старте Docker: `prisma db push`; при необходимости — миграции в контейнере.

3. **Backend: Auth** (2.1–2.8)  
   - Регистрация (телефон + код), вход, refresh, logout.  
   - Middleware: JWT, rate limiting.  
   - Восстановление пароля — в том же блоке или сразу после.

4. **Backend: профиль, ссылки, история, выводы** (3.1–3.5, 4.1–4.4)  
   - Эндпоинты профиля, генерация и хранение уникальной ссылки.  
   - История транзакций, заявки на вывод, расчёт баланса.

5. **Backend: платёжный модуль** (5.1–5.6)  
   - Интерфейс `PaymentGateway` и заглушка для демо.  
   - Эндпоинты `GET/POST /pay/:slug`, `POST /payment/webhook`.  
   - После твоей документации — замена заглушки на реальный адаптер.

6. **Frontend: лендинг** (6.1–6.8)  
   - Все секции по образцу 1tips, но с **новым дизайном** (палитра, типографика, сетка).  
   - Адаптив, хедер с навигацией и «Войти».  
   - **Футер** (логотип, ссылки на оферту/политику/контакты, реквизиты, поддержка) — данные из `FOOTER_DATA.placeholder.md`.  
   - Страницы документов **/oferta, /politika, /kontakty** с таким же футером; конфиг/плейсхолдер для данных футера.

7. **Frontend: auth и ЛК** (7.1–7.4, 8.1–8.6)  
   - Страницы входа, регистрации, восстановления.  
   - ЛК: профиль, ссылка, **QR-код** (генерация и скачивание), история, вывод.

8. **Frontend: страница приёма чаевых** (9.1–9.5)  
   - `/pay/:slug`: сумма, отзыв, кнопка оплаты, **QR на странице**.  
   - Экраны успех/ошибка.

9. **Интеграция с платёжным API** (10.1–10.3)  
   - После получения документации: реализация адаптера, вебхуки, тесты в sandbox.

10. **Тесты и деплой** (11.1–11.3, 12.1–12.4)  
    - Юнит и интеграционные тесты, README, OpenAPI, Docker, CI.

---

## Файлы в проекте

| Файл | Назначение |
|------|------------|
| `PROMPT.md` | Улучшенный промпт: цели, стандарты, функции, MVP, стек, уточняющие вопросы. |
| `TODO.md` | Единый список задач по статусам; **должен поддерживаться в актуальном состоянии**. |
| `ANALYZE_1TIPS.md` | Этот отчёт: разбор 1tips.ru и план действий. |
| `FOOTER_DATA.placeholder.md` | Шаблон данных для футера и документов (реквизиты, контакты, ссылки). Значения подставишь позже. |

---

## Отличия от 1tips в текущей реализации

- **Auth:** регистрация и вход по **логину** (не телефон). Подтверждение пароля при регистрации. Нет SMS и шага confirm. См. [docs/PROJECT_STATUS.md](docs/PROJECT_STATUS.md).

---

*После каждого ощутимого шага обновляется `TODO.md`. Актуальный контекст — `docs/PROJECT_STATUS.md`.*
